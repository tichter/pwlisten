<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8">
	<meta http-equiv="x-ua-compatible" content="ie=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="apple-touch-icon" sizes="180x180" href="https://tichter.github.io/pwlisten/images/favicon/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="https://tichter.github.io/pwlisten/images/favicon/favicon-32x32.png">
    <link rel="icon" type="image/png" sizes="16x16" href="https://tichter.github.io/pwlisten/images/favicon/favicon-16x16.png">
    <link rel="manifest" href="https://tichter.github.io/pwlisten/images/favicon/manifest.json">
    <link rel="mask-icon" href="https://tichter.github.io/pwlisten/images/favicon/safari-pinned-tab.svg" color="#5bbad5">
    <meta name="theme-color" content="#ffffff">

	<link href='https://fonts.googleapis.com/css?family=Open+Sans:400,300,700,800,600' rel='stylesheet' type='text/css'>
	<link href='https://fonts.googleapis.com/css?family=Muli:400,300' rel='stylesheet' type='text/css'>

    <!-- Include jQuery Mobile stylesheets -->
    <link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">

    <!-- Include the jQuery library -->
    <script src="https://code.jquery.com/jquery-1.11.1.min.js"></script>

    <!-- Include the jQuery Mobile library-->
    <script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>

    <!-- Listen -->
    <link rel="stylesheet" href="https://tichter.github.io/pwlisten/assets/css/listen.css">
    <script src="https://tichter.github.io/pwlisten/assets/js/listen.js"></script>

</head> 


<body>

<div data-role='page' id='id-pickthebest'>



<!-- Create Textfield + button
     on click
     write code to pickthebest.yml-->

<div data-role="header">

<a
    class='ui-btn-left ui-btn ui-btn-inline ui-mini
           ui-corner-all ui-btn-icon-left ui-icon-carat-l back'>
    Previous
</a>

<h1 class='title'>Task</h1>

<a
    href="https://tichter.github.io/pwlisten/pickthebest/"
    class='ui-btn-right ui-btn ui-btn-inline ui-mini
           ui-corner-all ui-btn-icon-right ui-icon-carat-r next'>
    Next
</a>

</div>





<!-- Popup window if all listener tries to move on before listening to all samples -->
<div data-role="popup" class="listen-to-all-samples-popup" data-position-to="window" data-transition="turn">
    <p>Please listen to all samples before moving on</p>
</div>

<div data-role="popup" class="submission-wait-popup" data-position-to="window" data-transition="turn">
    <p>Please wait for this page to redirect...</p>
</div>

<!-- Popup window for submissions -->
<div data-role='popup'
     data-position-to='window'
     class='ui-corner-all ui-popup ui-body-a ui-overlay-shadow submit-popup'
     data-theme='b'
     data-dismissible="false"
     >

<form method="post"
      action="https://api.staticman.net/v2/entry/tichter/pwlisten/gh-pages"
      class='submit-form'
      onsubmit='redirectfun(document.forms[0].intercode.value)'
      >

<h2>Thank you, please submit your data:</h2>

<input name="options[slug]" type="hidden" value='pickthebest'>
<input name="options[redirect]" id="redirectvalue" type="hidden" value="">

<input name='fields[experiment_id]'
       value='pickthebest'
       type='hidden'
>

<input name='fields[data]'
       value=''
       type='hidden'
>

<input type='submit'
       value='Submit'
       >

<input type='button'
       value='Cancel'
       class='cancel'
       >
<input type='hidden'
       name='intercode'
       value=''
       readonly
       >
</form>
</div>



<div id="inputstuff">
  <input type="text" id="inputcode"/>

  <input type="button" id="inputbutton" onclick="writeToPTByml()" value="Submit">
</div>

<div id="inDIV" class="ui-content">
Please enter the code, which was given you at Amazon MTurk in the textfield above and click on submit.
</div>

<!-- Main layout -->
<div data-role="main" class="ui-content" id="maincontent">
<h1 id="task">Task</h1>

<p>Please listen to the two samples below. Indicate which sample is more plesent to listen to, by checking <strong>one</strong> of the boxes. When you are done, press <code class="highlighter-rouge">Next</code> in the top right corner to get to the next sample (you will not be able to continue unless one sound has been checked).</p>

<p><strong>DO NOT</strong> forget to press submit in the popup after the last task. Otherwise your HIT will be rejected.</p>



<div class='interface-container'>

<div class="references-container" data-role="controlgroup" id="references"></div>

<div class="button-container" data-role="ui-content"></div>

<button class="stop-audio" data-inline="true" id="stopbutton">Stop Audio</button>

</div>

<!-- Popup windows-->
<div data-role="popup" class="ties-warning-popup" data-position-to="window" data-transition="turn">
    <p>Ties are not allowed, please check only one box</p>
</div>

<div data-role="popup" class=".no-selection-warning-popup" data-position-to="window" data-transition="turn">
    <p>Please check one box before continuing</p>
</div>

</div>



<script type="text/javascript">
document.getElementById("references").style.display = "none"
document.getElementById("stopbutton").style.visibility = "hidden"
document.getElementById("maincontent").style.visibility = "hidden"
function writeToPTByml() {
  let incode = document.getElementById("inputcode").value
  config = '{"continuous_playback":true,"loop_playback":true,"randomise_sounds_within_page":true,"randomise_pages":true,"must_play_all_samples_to_continue":false,"back_button_can_exit_test":false,"allow_ties":false,"allow_early_finish":false,"allow_submission":true,"add_consistency_check":false,"incode":"","codes":[{"code":"test1","intercode":"inttest1","pages":[{"name":"Set 1","references":[{"button_label":"Reference vocals","url":"sounds/Al James - Schoolboy Facination/ref_vocals.flac"}],"sounds":[{"name":"JY3","url":"sounds/Al James - Schoolboy Facination/JY3_vocals.flac"},{"name":"MDL1","url":"sounds/Al James - Schoolboy Facination/MDL1_vocals.flac"}]},{"name":"Set 2","references":[{"button_label":"Reference vocals","url":"sounds/Al James - Schoolboy Facination/ref_vocals.flac"}],"sounds":[{"name":"TAU1","url":"sounds/Al James - Schoolboy Facination/TAU1_vocals.flac"},{"name":"UHL3","url":"sounds/Al James - Schoolboy Facination/UHL3_vocals.flac"}]},{"name":"Set 3","references":[{"button_label":"Reference vocals","url":"sounds/Al James - Schoolboy Facination/ref_vocals.flac"}],"sounds":[{"name":"JY3","url":"sounds/Al James - Schoolboy Facination/JY3_vocals.flac"},{"name":"UHL3","url":"sounds/Al James - Schoolboy Facination/UHL3_vocals.flac"}]}]},{"code":"test2","intercode":"inttest2","pages":[{"name":"Set 1","references":[{"button_label":"Reference vocals","url":"sounds/Angels In Amplifiers - I_m Alright/ref_vocals.flac"}],"sounds":[{"name":"TAU1","url":"sounds/Angels In Amplifiers - I_m Alright/TAU1_vocals.flac"},{"name":"UHL3","url":"sounds/Angels In Amplifiers - I_m Alright/UHL3_vocals.flac"}]},{"name":"Set 2","references":[{"button_label":"Reference vocals","url":"sounds/Angels In Amplifiers - I_m Alright/ref_vocals.flac"}],"sounds":[{"name":"JY3","url":"sounds/Angels In Amplifiers - I_m Alright/JY3_vocals.flac"},{"name":"MDL1","url":"sounds/Angels In Amplifiers - I_m Alright/MDL1_vocals.flac"}]}]}]}'
  config = JSON.parse(config)
  var existsincode = false
  for (let i = 0; i<config.codes.length; i++){
    if (config.codes[i].code === incode){
      existsincode = true
    }
  }
  if (existsincode){
    config.incode = incode

    document.getElementById("inputstuff").style.display = "none"
    document.getElementById("inDIV").style.display = "none"

    document.getElementById("references").style.display = "none"
    document.getElementById("stopbutton").style.visibility = ""
    document.getElementById("maincontent").style.visibility = ""
    config = JSON.stringify(config)

    window.listen.createPickTheBest(config, 'https://tichter.github.io/pwlisten')
  } else {
    document.getElementById("inputcode").value = "Code does not exist."
  }
}
function redirectfun(retcode){
  document.getElementById("inputcode").style.display = "none"
  document.getElementById("inputcode").value = retcode
  var url = "https://tichter.github.io/pwlisten/returncode/?="
  url += document.forms[0].intercode.value
  document.getElementById("redirectvalue").value = url
}

</script>

</div>
</body>
</html>
